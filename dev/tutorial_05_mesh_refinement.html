<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial 05 Mesh Refinement · WavesAndEigenvalues.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">WavesAndEigenvalues.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="installation.html">Install</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="tutorial_00_NLEVP.html">Tutorial 00 Introduction to the NLEVP module</a></li><li><a class="tocitem" href="tutorial_01_rijke_tube.html">Tutorial 01 Rijke Tube</a></li><li><a class="tocitem" href="tutorial_02_global_eigenvalue_solver.html">Tutorial 02 Beyn&#39;s Global Eigenvalue Solver</a></li><li><a class="tocitem" href="tutorial_03_local_eigenvalue_solver.html">Tutorial 03  A Local Eigenvalue Solver</a></li><li><a class="tocitem" href="tutorial_04_perturbation_theory.html">Tutorial 04 Perturbation Theory</a></li><li class="is-active"><a class="tocitem" href="tutorial_05_mesh_refinement.html">Tutorial 05 Mesh Refinement</a><ul class="internal"><li><a class="tocitem" href="#Intro"><span>Intro</span></a></li><li><a class="tocitem" href="#Basic-set-up"><span>Basic set-up</span></a></li><li><a class="tocitem" href="#refine-mesh"><span>refine mesh</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="tutorial_06_second_order_elements.html">Tutorial 06 Second Order Elements</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="NLEVP.html">The NLEVP module</a></li><li><a class="tocitem" href="Meshutils.html">The Meshutils module</a></li><li><a class="tocitem" href="Helmholtz.html">The Helmholtz module</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="tutorial_05_mesh_refinement.html">Tutorial 05 Mesh Refinement</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tutorial_05_mesh_refinement.html">Tutorial 05 Mesh Refinement</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial-05-Mesh-Refinement"><a class="docs-heading-anchor" href="#Tutorial-05-Mesh-Refinement">Tutorial 05 Mesh Refinement</a><a id="Tutorial-05-Mesh-Refinement-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial-05-Mesh-Refinement" title="Permalink"></a></h1><h2 id="Intro"><a class="docs-heading-anchor" href="#Intro">Intro</a><a id="Intro-1"></a><a class="docs-heading-anchor-permalink" href="#Intro" title="Permalink"></a></h2><p>This tutorial explains you to utilities for performing mesh-refinement. The main function here is <code>finer_mesh=octosplit(mesh)</code>, which splits all tetrahedral cells in <code>mesh</code> by bisecting each edge. This will lead to a subdivision of each tetrahedron into eight new tetrahedra. Such a division is not unique. There are three ways of splitting a tetrahedron into eight new tetrahedra and bisecting all six original edges. <code>octosplit</code> chooses the splitting such that the maximum of the newly created edges is minimized.</p><h2 id="Basic-set-up"><a class="docs-heading-anchor" href="#Basic-set-up">Basic set-up</a><a id="Basic-set-up-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-set-up" title="Permalink"></a></h2><p>We start with initializing the standard Rijke-Tube example.</p><pre><code class="language-julia">using WavesAndEigenvalues.Helmholtz
mesh=Mesh(&quot;Rijke_mm.msh&quot;,scale=0.001)
dscrp=Dict() #initialize model descriptor
dscrp[&quot;Interior&quot;]=(:interior, ()) #define resonant cavity
dscrp[&quot;Outlet&quot;]=(:admittance, (:Y,1E15)) #specify outlet BC
γ=1.4 #ratio of specific heats
ρ=1.225 #density at the reference location upstream to the flame in kg/m^3
Tu=300.0    #K unburnt gas temperature
Tb=1200.0    #K burnt gas temperature
P0=101325.0 #ambient pressure in Pa
A=pi*0.025^2 #cross sectional area of the tube
Q02U0=P0*(Tb/Tu-1)*A*γ/(γ-1) #the ratio of mean heat release to mean velocity Q02U0
x_ref=[0.0; 0.0; -0.00101] #reference point
n_ref=[0.0; 0.0; 1.00] #directional unit vector of reference velocity
n=0.01 #interaction index
τ=0.001 #time delay
dscrp[&quot;Flame&quot;]=(:flame,(γ,ρ,Q02U0,x_ref,n_ref,:n,:τ,n,τ)) #flame dynamics
R=287.05 # J/(kg*K) specific gas constant (air)
speedofsound(x,y,z) = z&lt;0. ? sqrt(γ*R*Tu) : sqrt(γ*R*Tb)
c=generate_field(mesh,speedofsound)
L=discretize(mesh,dscrp,c)
sol,nn,flag=householder(L,400*2*pi,maxiter=10)
data=Dict()
data[&quot;speed_of_sound&quot;]=c
data[&quot;abs&quot;]=abs.(sol.v)/maximum(abs.(sol.v)) #normalize so that max=1
data[&quot;phase&quot;]=angle.(sol.v)
vtk_write(&quot;test&quot;, mesh, data) # Write the solution to paraview</code></pre><pre><code class="language-none">Launching Householder...
Iter    Res:     dz:     z:
----------------------------------
0		Inf	Inf	2513.2741228718346
1		3.3678010621821997e6	672.6717790631509	1840.644381094955 + 7.520161245130288im
2		457309.5623269443	125.32039552244363	1715.3398137797765 + 9.511880065048567im
3		15754.920293139632	4.636826536115793	1710.7041295613465 + 9.614798251130926im
4		21.537680317163897	0.006356125798411251	1710.6977772512585 + 9.615018459466514im
5		4.045803703302238e-5	1.1939919720254716e-8	1710.6977772393393 + 9.615018460170372im
6		2.6334860638026723e-8	7.85077700900375e-12	1710.6977772393466 + 9.61501846017332im
7		1.4995064722670382e-8	4.324048085871753e-12	1710.6977772393423 + 9.615018460173136im
8		1.0838615959911618e-8	3.1913416131870233e-12	1710.697777239339 + 9.615018460173363im
9		1.4098455247391106e-8	4.099642246569255e-12	1710.6977772393432 + 9.615018460173125im
10		1.919724130587623e-9	4.655004020764636e-13	1710.6977772393427 + 9.615018460173225im
Warning: Maximum number of iterations has been reached!
...finished Householder!
#####################
 Householder results 
#####################
Number of steps: 10
Last step parameter variation:4.655004020764636e-13
Auxiliary eigenvalue λ residual (rhs):1.919724130587623e-9
Eigenvalue:1710.6977772393427 + 9.615018460173225im
Eigenvalue/(2*pi):272.26600738395945 + 1.5302777158563927im
</code></pre><h2 id="refine-mesh"><a class="docs-heading-anchor" href="#refine-mesh">refine mesh</a><a id="refine-mesh-1"></a><a class="docs-heading-anchor-permalink" href="#refine-mesh" title="Permalink"></a></h2><p>Now let&#39;s call <code>octosplit</code> for creating the refined mesh</p><pre><code class="language-julia">fine_mesh=octosplit(mesh)</code></pre><pre><code class="language-none">mesh: Rijke_mm.msh
#################
points:     6172
lines:      0
triangles:  6248
tetrahedra: 27040
#################
domains: Cold, Flame, Flame_in, Flame_out, Hot, Inlet, Interior, Outlet, Walls</code></pre><p>and solve the problem again with the fine mesh for comparison.</p><pre><code class="language-julia">c=generate_field(fine_mesh,speedofsound)
L=discretize(fine_mesh,dscrp,c)
sol,nn,flag=householder(L,400*2*pi,maxiter=10)
#write to file
data=Dict()
data[&quot;speed_of_sound&quot;]=c
data[&quot;abs&quot;]=abs.(sol.v)/maximum(abs.(sol.v)) #normalize so that max=1
data[&quot;phase&quot;]=angle.(sol.v)
vtk_write(&quot;fine_test&quot;, fine_mesh, data) # Write the solution to paraview

# If you think that&#39;s not enough, well, then try...
fine_mesh=octosplit(fine_mesh)</code></pre><pre><code class="language-none">mesh: Rijke_mm.msh
#################
points:     42507
lines:      0
triangles:  24992
tetrahedra: 216320
#################
domains: Cold, Flame, Flame_in, Flame_out, Hot, Inlet, Interior, Outlet, Walls</code></pre><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>The <code>octosplit</code>-function allows you to refine your mesh by bisecting all edges. This creates a new mesh with eight-times as many tetrahedral cells. The tool is quite useful for running h-convergence tests for your set-up.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="tutorial_04_perturbation_theory.html">« Tutorial 04 Perturbation Theory</a><a class="docs-footer-nextpage" href="tutorial_06_second_order_elements.html">Tutorial 06 Second Order Elements »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 25 March 2021 10:32">Thursday 25 March 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
